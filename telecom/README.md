## Стек технологий:
`Python`
`Pandas`
`Matplotlib`
`Seaborn`
`sklearn`
`Catboost`
`машинное обучение`

<div style="background: linear-gradient(to bottom, #ffffff, #f2f2f2);
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 10px;">

# Отчет по проекту

### Описание задачи
В данном проекте мы решали задачу бинарной классификации для определения ухода клиента из телекоммуникационной компании. Наша задача заключалась в том, чтобы построить модель, которая сможет предсказывать, уйдет ли клиент из компании в ближайшее время или останется.

### Шаги работы над проектом:

1) Изучение данных и их предобработка.
- Провели анализ данных, обнаружили пропущенные значения и заменили их средним значением.
- Создали дополнительный признак **`totaldays`** - количество дней пользования услугами компании.
- Создали новый столбец **`escape`** и обнаружили дисбаланс классов в целевом признаке, где **`84%`** клиентов остались в компании, а **`16%`** ушли. ![image](https://github.com/Ptolemey98/YP_Projects/assets/113921336/5edb8cf0-50a8-4602-bee2-15e70a1543b2)
- По итогам предобработки объединили все признаки в одну таблицу и удалили ненужные.

2) Обучение моделей.
- Обучили несколько моделей, включая **`LogisticRegression`**, **`RandomForestClassifier`** и **`CatBoostClassifier`**.
- При оценки качества моделей использовали метрику **`ROC-AUC`** на кросс-валидации и на тестовой выборке.
| Модель | ROC-AUC |
|--------|---------|
| LogisticRegression | 0.714 | 
| RandomForestClassifier | 0.817 |
| CatBoostClassifier | 0.918 | 

3) Тестирование модели.
- Выбрали лучшую модель **`CatBoostClassifier`** с лучшим результатом. Оценили лучшую модель на тестовой выборке.

| Модель | ROC-AUC | ROC-AUC на тесте | Accuracy на тесте |
|--------|---------|----------|----------|
| CatBoostClassifier | 0.918 | 0.921 | 0.938 |

- Анализ матрицы ошибок и выявил, что модель предсказывает правильно **`2/3`** уходящих клиентов.
- Провели анализ важности признаков и выявили наиболее важные признаки для прогнозирования оттока клиентов, а именно:
    * `totaldays` - количество дней пользования услугами компании.
    * `monthlycharges` - ежемесячные траты на услуги.
    
![image](https://github.com/Ptolemey98/YP_Projects/assets/113921336/76f68787-f392-4c9a-b58b-a49a800c55f0)

#### Итоговый список признаков для обучения модели:
    
- `totaldays` - количество дней пользования услугами компании (численный признак);
- `monthlycharges` - ежемесячные траты на услуги (численный признак);
- `partner` - наличие партнера (бинарный признак);
- `tech_support` - наличие услуги технической поддержки (бинарный признак);
- `online_backup` - наличие услуги резервного копирования данных (бинарный признак);
- `multiple_lines` - наличие нескольких линий связи (бинарный признак);
- `online_security` - наличие услуги блокировки сайтов (бинарный признак);
- `device_protection` - наличие антивируса (бинарный признак);
- `payment_method` - метод оплаты (категориальный признак).

Для обработки данных использовали методы кодирования категориальных признаков (**`One-Hot Encoding`**) и стандартизации числовых признаков (**`StandardScaler`**).
    

**Соответствие плана фактической работе** - В целом, работа над проектом шла по плану. Однако, были некоторые отклонения, связанные с обработкой данных.

- Например, встречалась ***мультиколлинеарность*** признаков, что могло привести к переобучению модели. Решение этой проблемы потребовало дополнительного анализа и удаления наиболее скоррелированных признаков. 

- Также мы столкнулись с проблемой ***дисбаланса*** классов в целевом признаке. Было решено не трогать этот дисбаланс, но можно попробовать использовать различные методы балансировки классов, такие как взвешивание классов, увеличение выборки минорного класса и уменьшение выборки мажорного класса.

- Также были некоторые трудности с обучением нескольких моделей для определения лучшей. Мы решили эту проблему путем использования **`Pipeline`** для обработки данных и построения модели. Он позволил автоматизировать процесс обработки данных и построения модели, что упростило работу и позволило быстрее получить результаты.

    
**Итоговая модель** - **`CatBoostClassifier`** с метрикой **`ROC-AUC`** на кросс-валидации **`0.921`** и **`Accuracy`** **`0.938`** на тестовой выборке. Гиперпараметры модели были подобраны с помощью **`GridSearchCV`**.

| Модель | Гиперпараметры | ROC-AUC на тесте | Accuracy на тесте |
|----------------------|-------------------------------|-----------------|-------------------|
| CatBoostClassifier | learning_rate=0.1, max_depth=5 | 0.921 | 0.938 |
 

**По итогам работы** мы успешно решили поставленную задачу и построили модель, которая может предсказывать, уйдет ли клиент из компании в ближайшее время или останется. Мы выявили наиболее важные признаки для прогнозирования оттока клиентов и определили лучшую модель для решения задачи. Это позволит компании принимать меры по удержанию клиентов и улучшению качества услуг.
     </div>

---

#### Если проект не открывается, его можно просмотреть по ссылке: <a href='https://nbviewer.org/github/Ptolemey98/YP_Projects/blob/main/telecom/Final_telecom.ipynb'>telecoms</a>


